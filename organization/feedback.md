# 经验反哺规范机制

## 一、基本原则

### 1. 反哺触发
- 经验积累触发：
  * 多次验证的经验
  * 高价值的发现
  * 重复出现的模式
  * 普遍适用的方法

- 问题发现触发：
  * 规范执行障碍
  * 规范适用性问题
  * 规范效果不佳
  * 规范存在冲突

### 2. 反哺方向
- 经验 → 规范：
  * 日常经验 → 项目规范
  * 项目经验 → 通用规范
  * 通用经验 → 基本规范
  * 创新经验 → 规范优化

## 二、反哺流程

### 1. 经验评估
- 价值评估：
  * 使用频率统计
  * 适用范围分析
  * 效果评估数据
  * 成本收益分析

- 可行性评估：
  * 技术可行性
  * 实施难度
  * 风险评估
  * 资源需求

### 2. 规范更新
- 更新分析：
  * 影响范围评估
  * 变更成本评估
  * 兼容性分析
  * 风险评估

- 更新实施：
  * 规范修订
  * 评审确认
  * 版本发布
  * 执行验证

## 三、执行机制

### 1. AI执行职责
- 经验发现：
  * 持续跟踪经验积累
  * 识别有价值经验
  * 发现潜在的规范改进点
  * 准备更新建议

- 更新支持：
  * 准备更新提案
  * 提供必要的分析
  * 执行确认的更新
  * 维护更新记录

### 2. 用户职责
- 评估决策：
  * 评估更新必要性
  * 评估更新可行性
  * 决定是否更新
  * 确定更新范围

- 监督指导：
  * 审核更新内容
  * 确认更新效果
  * 决定是否回滚
  * 指导优化方向

## 四、质量保障

### 1. 更新质量
- 内容质量：
  * 准确性检查
  * 完整性验证
  * 一致性确认
  * 可用性评估

- 过程质量：
  * 流程规范性
  * 文档完整性
  * 验证充分性
  * 效果评估

### 2. 效果验证
- 验证方法：
  * 实践验证
  * 用户反馈
  * 效果评估
  * 持续监控

- 问题处理：
  * 问题收集
  * 原因分析
  * 解决方案
  * 效果跟踪

## 五、规范更新映射

### 1. 经验类型与规范映射
- 架构经验：
  * 更新 organization/architecture.md
  * 涉及系统整体架构
  * 模块关系调整
  * 核心机制变更

- 协作经验：
  * 更新 specification/ai_general.md
  * 更新 specification/human.md
  * 涉及交互方式
  * 协作流程优化

- 项目经验：
  * 更新 specification/project.md
  * 涉及项目实施
  * 开发流程优化
  * 质量控制改进

- 经验管理经验：
  * 更新 organization/experience.md
  * 涉及经验记录方式
  * 经验组织优化
  * 经验提炼流程

### 2. 更新优先级
- 必须更新：
  * 影响系统稳定性
  * 影响协作效率
  * 影响项目质量
  * 重大优化机会

- 建议更新：
  * 改进用户体验
  * 提升工作效率
  * 优化现有流程
  * 增强系统能力

### 3. 更新范围
- 局部更新：
  * 单个规范文件
  * 特定章节内容
  * 具体执行细节
  * 独立功能模块

- 关联更新：
  * 多个相关规范
  * 跨文件一致性
  * 关联机制调整
  * 整体优化改进

## 六、更新实施规范

### 1. 更新提案格式
```markdown
# 规范更新提案

## 基本信息
- 更新时间：YYYY-MM-DD
- 更新文件：[文件路径]
- 更新类型：[必要更新/建议更新]
- 来源经验：[经验文件路径及位置]
- 影响范围：[局部更新/关联更新]

## 更新内容
### 1. 原内容
[需要更新的原始内容]

### 2. 更新内容
[具体的更新内容]

### 3. 更新原因
- 经验来源说明
- 更新必要性分析
- 预期改进效果
- 可能的影响

## 评估信息
- 技术可行性：
- 实施难度：
- 预期收益：
- 潜在风险：

## 相关方
- 提案人：
- 评审人：
- 执行人：
- 验证人：
```

### 2. 更新记录格式
```markdown
# 规范更新记录

## 更新信息
- 执行时间：YYYY-MM-DD HH:mm
- 更新文件：[文件路径]
- 关联文件：[相关文件路径]
- 更新状态：[已完成/验证中/已回滚]

## 更新内容
- 具体更新：[更新内容概述]
- 影响范围：[影响的范围和模块]
- 关联更新：[相关的更新操作]

## 验证结果
- 验证方法：
- 验证结果：
- 问题记录：
- 改进建议：

## 追踪信息
- 提案编号：
- 执行人：
- 验证人：
- 完成时间：
```

### 3. 追踪机制
- 更新编号规则：
  * 格式：UPDATE-YYYYMMDD-XXX
  * YYYY：年份
  * MM：月份
  * DD：日期
  * XXX：序号

- 状态追踪：
  * 提案阶段
  * 评审阶段
  * 执行阶段
  * 验证阶段
  * 完成归档

- 文件关联：
  * 提案文件
  * 更新记录
  * 验证报告
  * 相关经验
```

## 七、更新提案交互

### 1. 提案提交
- AI职责：
  * 准备更新提案文档
  * 说明："基于[经验来源]，我建议更新[规范文件]，主要更新[内容概述]"
  * 展示：完整的更新提案
  * 等待：用户评估和决策

- 用户职责：
  * 审阅提案内容
  * 评估更新必要性
  * 决定是否执行
  * 提供修改建议

### 2. 交互流程
- 提案阶段：
  * AI: "我发现一个可能的规范改进点"
  * AI: 展示更新提案
  * 用户: 审阅和评估
  * 用户: 做出决策

- 讨论阶段：
  * 用户可以提出疑问
  * AI解释具体原因
  * 用户提供修改建议
  * AI调整更新内容

- 决策阶段：
  * 用户：同意/拒绝/要求修改
  * AI：执行相应操作
  * AI：记录决策过程
  * AI：更新相关文档

### 3. 评估指南
- 用户评估维度：
  * 必要性：这个更新是否必要？
  * 合理性：更新内容是否合理？
  * 影响性：影响范围是否可控？
  * 时机性：当前是否适合更新？

- 评估反馈：
  * 同意：直接批准更新
  * 拒绝：说明拒绝原因
  * 修改：提供修改建议
  * 延后：说明延后原因

### 4. 执行确认
- 更新前：
  * AI: 展示具体的更新内容
  * AI: 说明更新步骤
  * 用户: 最终确认
  * AI: 记录确认结果

- 更新后：
  * AI: 展示更新结果
  * AI: 提供变更对比
  * 用户: 验证更新
  * AI: 记录完成状态
```

## 八、提案管理机制

### 1. 提案存储
- 存储位置：
  ```
  helpAi/
  ├── proposals/           # 规范更新提案
  │   ├── pending/        # 待处理提案
  │   │   └── YYYYMMDD-序号-关键词/
  │   │       ├── proposal.md    # 提案文档
  │   │       ├── discussion.md  # 讨论记录
  │   │       └── status.md      # 状态跟踪
  │   ├── approved/       # 已批准提案
  │   └── rejected/       # 已拒绝提案
  ```

### 2. 交互方式
- 提案提交：
  * AI: "@用户 我有一个规范更新提案"
  * AI: 提供提案路径 "proposals/pending/[提案目录]"
  * AI: 简要说明更新要点
  * AI: 请求用户查看和评估

- 用户响应：
  * 直接在 discussion.md 中回复
  * 使用简单的指令：
    - `#同意` - 批准提案
    - `#拒绝 [原因]` - 拒绝提案
    - `#修改 [建议]` - 要求修改
    - `#延后 [原因]` - 暂不处理
    - `#问题 [内容]` - 提出疑问

### 3. 状态追踪
- status.md 格式：
  ```markdown
  # 提案状态
  - 创建时间：YYYY-MM-DD HH:mm
  - 当前状态：[待处理/讨论中/已批准/已拒绝]
  - 最后更新：YYYY-MM-DD HH:mm
  - 相关经验：[经验路径]
  - 目标规范：[规范文件]
  
  ## 状态历史
  - [时间] [状态] [操作人] [说明]
  - ...
  
  ## 待处理事项
  - [ ] 事项1
  - [ ] 事项2
  ```

### 4. 执行流程
1. AI发现需要更新规范时：
   - 创建提案目录和文件
   - 通知用户新提案
   - 等待用户响应

2. 用户查看提案后：
   - 在 discussion.md 中交流
   - 使用指令表明决定
   - AI更新状态记录

3. 提案批准后：
   - AI执行规范更新
   - 移动到 approved/
   - 记录执行结果

4. 提案拒绝后：
   - 移动到 rejected/
   - 记录拒绝原因
   - 积累经验